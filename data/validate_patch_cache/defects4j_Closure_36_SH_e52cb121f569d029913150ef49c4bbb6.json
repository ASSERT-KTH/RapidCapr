{
    "patch": "          Node callTarget = reference.getFirstChild();\n          if (callTarget.isGetProp() && callTarget.getNext() == null) {\n            // As well as the special case of the singleton getter, ignore \"class\" and \"super\"\n            // and properties called \"then\" and \"catch\" on Promises.\n            boolean isPropertyNameValid =\n                !callTarget.getLastChild().getString().equals(\"class\")\n                    && !callTarget.getLastChild().getString().equals(\"super\")\n                    && !(value.isCall() && (callTarget.getLastChild().getString().equals(\"then\")\n                        || callTarget.getLastChild().getString().equals(\"catch\")));\n            if (isPropertyNameValid) {\n              Node targetObject = callTarget.getFirstChild();\n              if (targetObject.matchesQualifiedName(\"com.google.javascript.jscomp\" +\n                      \".JSCompiler.Promise\") || targetObject.matchesQualifiedName(\n                      \"com.google.common.util.concurrent.Futures.immediateFuture\")) {\n                return false;\n              }\n\n              ObjectType promiseType = compiler.getTypeRegistry().getNativeObjectType(\n                  JSTypeNative.PROMISE_TYPE);\n              if (targetObject.getJSType().isSubtypeOf(promiseType)) {\n                String lastPropertyName = callTarget.getLastChild().getString();\n                if (LAST_PROMISE_METHODS.contains(lastPropertyName)) {\n                  return false;\n                }\n                Node cur = callTarget.getParent();\n                while (cur != null) {\n                  if (cur.isCall() && cur.getFirstChild() == targetObject) {\n                    return false;\n                  }\n                  cur = cur.getParent();\n                }\n              }\n            }\n          }",
    "patch_diff": "diff --git a/src/com/google/javascript/jscomp/InlineVariables.java b/src/com/google/javascript/jscomp/InlineVariables.java\nindex 0b4b3ded..e35055d8 100644\n--- a/src/com/google/javascript/jscomp/InlineVariables.java\n+++ b/src/com/google/javascript/jscomp/InlineVariables.java\n@@ -572,6 +572,40 @@ class InlineVariables implements CompilerPass {\n \n           // issue 668: Don't inline singleton getter methods\n           // calls as this confused class removing logic.\n+          Node callTarget = reference.getFirstChild();\n+          if (callTarget.isGetProp() && callTarget.getNext() == null) {\n+            // As well as the special case of the singleton getter, ignore \"class\" and \"super\"\n+            // and properties called \"then\" and \"catch\" on Promises.\n+            boolean isPropertyNameValid =\n+                !callTarget.getLastChild().getString().equals(\"class\")\n+                    && !callTarget.getLastChild().getString().equals(\"super\")\n+                    && !(value.isCall() && (callTarget.getLastChild().getString().equals(\"then\")\n+                        || callTarget.getLastChild().getString().equals(\"catch\")));\n+            if (isPropertyNameValid) {\n+              Node targetObject = callTarget.getFirstChild();\n+              if (targetObject.matchesQualifiedName(\"com.google.javascript.jscomp\" +\n+                      \".JSCompiler.Promise\") || targetObject.matchesQualifiedName(\n+                      \"com.google.common.util.concurrent.Futures.immediateFuture\")) {\n+                return false;\n+              }\n+\n+              ObjectType promiseType = compiler.getTypeRegistry().getNativeObjectType(\n+                  JSTypeNative.PROMISE_TYPE);\n+              if (targetObject.getJSType().isSubtypeOf(promiseType)) {\n+                String lastPropertyName = callTarget.getLastChild().getString();\n+                if (LAST_PROMISE_METHODS.contains(lastPropertyName)) {\n+                  return false;\n+                }\n+                Node cur = callTarget.getParent();\n+                while (cur != null) {\n+                  if (cur.isCall() && cur.getFirstChild() == targetObject) {\n+                    return false;\n+                  }\n+                  cur = cur.getParent();\n+                }\n+              }\n+            }\n+          }\n         }\n       }\n ",
    "result_reason": "error: cannot find symbol",
    "test_result": "ERROR"
}