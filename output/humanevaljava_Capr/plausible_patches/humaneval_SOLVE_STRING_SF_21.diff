diff --git a/src/main/java/humaneval/buggy/SOLVE_STRING.java b/src/main/java/humaneval/buggy/SOLVE_STRING.java
index e31e9a2..7a8f906 100644
--- a/src/main/java/humaneval/buggy/SOLVE_STRING.java
+++ b/src/main/java/humaneval/buggy/SOLVE_STRING.java
@@ -11,18 +11,31 @@ package humaneval.buggy;
 // solve("#a@C") = "#A@c"
 
 public class SOLVE_STRING {
-    public static String solve_string(String s) {
-        int flg = 0;
-        StringBuilder sb = new StringBuilder();
-        for (char c : s.toCharArray()) {
-            if (Character.isLowerCase(c)) sb.append(Character.toUpperCase(c));
-            else sb.append(Character.toLowerCase(c));
-            flg = 1;
+public static String solve_string(String s) {
+    boolean hasLowerCase = false;
+    for (int i = 0; i < s.length(); i++) { // use indexed loop for efficiency
+        char c = s.charAt(i);
+        if (Character.isLowerCase(c)) {
+            hasLowerCase = true;
+            break;
         }
-        if (flg == 0) {
-            sb = new StringBuilder();
-            for (int i = s.length() - 1; i >= 0; i -= 1) sb.append(s.charAt(i));
+    }
+    StringBuilder sb = new StringBuilder(s.length()); // initialize with capacity for efficiency
+    if (hasLowerCase) {
+        for (int i = 0; i < s.length(); i++) {
+            char c = s.charAt(i);
+            if (Character.isLowerCase(c)) {
+                c = Character.toUpperCase(c);
+            } else {
+                c = Character.toLowerCase(c);
+            }
+            sb.append(c);
+        }
+    } else {
+        for (int i = s.length() - 1; i >= 0; i--) {
+            sb.append(s.charAt(i));
         }
-        return sb.toString();
     }
+    return sb.toString();
+}
 }