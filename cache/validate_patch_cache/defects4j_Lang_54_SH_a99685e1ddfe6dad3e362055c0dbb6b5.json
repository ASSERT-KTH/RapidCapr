{
    "patch": "char ch2 = str.charAt(2);\nif ((len == 7 && (ch2 != '_' || !(str.charAt(3) == 'P' && str.charAt(4) == 'O' && str.charAt(5) == 'S' && str.charAt(6) == 'I' && len == 7))) || (len > 7 && ch2 != '_')) {\n    throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n} else {\n    for (int i = 3; i < len; i++) {\n        if (i == 5 && ch2 == '_') {\n            continue;\n        }\n        char ch = str.charAt(i);\n        if (ch != '_' && !Character.isUpperCase(ch)) {\n            throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n        }\n    }\n}",
    "patch_diff": "diff --git a/src/java/org/apache/commons/lang/LocaleUtils.java b/src/java/org/apache/commons/lang/LocaleUtils.java\nindex 139d9a7f..43c987f1 100644\n--- a/src/java/org/apache/commons/lang/LocaleUtils.java\n+++ b/src/java/org/apache/commons/lang/LocaleUtils.java\n@@ -111,6 +111,20 @@ public class LocaleUtils {\n                 throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n             }\n             char ch3 = str.charAt(3);\n+char ch2 = str.charAt(2);\n+if ((len == 7 && (ch2 != '_' || !(str.charAt(3) == 'P' && str.charAt(4) == 'O' && str.charAt(5) == 'S' && str.charAt(6) == 'I' && len == 7))) || (len > 7 && ch2 != '_')) {\n+    throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n+} else {\n+    for (int i = 3; i < len; i++) {\n+        if (i == 5 && ch2 == '_') {\n+            continue;\n+        }\n+        char ch = str.charAt(i);\n+        if (ch != '_' && !Character.isUpperCase(ch)) {\n+            throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n+        }\n+    }\n+}\n             char ch4 = str.charAt(4);\n             if (ch3 < 'A' || ch3 > 'Z' || ch4 < 'A' || ch4 > 'Z') {\n                 throw new IllegalArgumentException(\"Invalid locale format: \" + str);",
    "result_reason": "java.lang.IllegalArgumentException: Invalid locale format: fr__POSIX",
    "test_result": "FAIL"
}